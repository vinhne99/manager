<div class="page-title">
    <div class="title_left">
        <h3>Trang chủ - Danh sách sản phẩm</h3>
    </div>
</div>
<div class="clearfix"></div>
<div class="row">
    <div class="col-md-12 col-sm-12 col-xs-12">
        <div class="x_panel">
            <div class="x_title">
                <h2>Quản lý sản phẩm</h2>
                <ul class="nav navbar-right panel_toolbox">
                    <li><a class="collapse-link"><i class="fa fa-chevron-up"></i></a>
                    </li>

                    <li><a class="close-link"><i class="fa fa-close"></i></a>
                    </li>
                </ul>
                <div class="clearfix"></div>
            </div>
            <div class="x_content">
                <a href="<?php echo base_url(); ?>admin/product/create"  class="btn btn-primary"><i class="fa fa-plus"></i> Thêm mới sản phẩm</a>
                    <table class="table table-striped responsive-utilities jambo_table bulk_action">
                        <thead>
                        <tr class="headings">
                            <th>
                                <input type="checkbox" id="check-all" class="flat">
                            </th>
                            <th class="column-title">ID </th>
                            <th class="column-title">Hình ảnh </th>
                            <th class="column-title">Tên sản phẩm </th>
                            <th class="column-title">Giá</th>
                            <th class="column-title">Giá(KM)</th>
                            <th class="column-title">Ngày</th>
                            <th class="column-title no-link last"><span class="nobr">Hành dộng</span>
                            </th>
                            <th class="bulk-actions" colspan="7">
                                <a class="antoo" style="color:#fff; font-weight:500;">Dòng chọn xóa (<span class="action-cnt"> </span> ) <i class="fa fa-chevron-down"></i></a>
                            </th>
                        </tr>
                        </thead>

                        <tbody>
                        <tr class="even pointer">
                            <td class="a-center ">
                                <input type="checkbox" class="flat" name="table_records">
                            </td>
                            <td class=" ">121000040</td>
                            <td class=" ">May 23, 2014 11:47:56 PM </td>
                            <td class=" ">121000210 <i class="success fa fa-long-arrow-up"></i></td>
                            <td class=" ">John Blank L</td>
                            <td class=" ">Paid</td>
                            <td class="a-right a-right ">$7.45</td>
                            <td class=" last"><a href="#">View</a>
                            </td>
                        </tr>
                        <tr class="odd pointer">
                            <td class="a-center ">
                                <input type="checkbox" class="flat" name="table_records">
                            </td>
                            <td class=" ">121000039</td>
                            <td class=" ">May 23, 2014 11:30:12 PM</td>
                            <td class=" ">121000208 <i class="success fa fa-long-arrow-up"></i>
                            </td>
                            <td class=" ">John Blank L</td>
                            <td class=" ">Paid</td>
                            <td class="a-right a-right ">$741.20</td>
                            <td class=" last"><a href="#">View</a>
                            </td>
                        </tr>
                        <tr class="even pointer">
                            <td class="a-center ">
                                <input type="checkbox" class="flat" name="table_records">
                            </td>
                            <td class=" ">121000038</td>
                            <td class=" ">May 24, 2014 10:55:33 PM</td>
                            <td class=" ">121000203 <i class="success fa fa-long-arrow-up"></i>
                            </td>
                            <td class=" ">Mike Smith</td>
                            <td class=" ">Paid</td>
                            <td class="a-right a-right ">$432.26</td>
                            <td class=" last"><a href="#">View</a>
                            </td>
                        </tr>
                        <tr class="odd pointer">
                            <td class="a-center ">
                                <input type="checkbox" class="flat" name="table_records">
                            </td>
                            <td class=" ">121000037</td>
                            <td class=" ">May 24, 2014 10:52:44 PM</td>
                            <td class=" ">121000204</td>
                            <td class=" ">Mike Smith</td>
                            <td class=" ">Paid</td>
                            <td class="a-right a-right ">$333.21</td>
                            <td class=" last"><a href="#">View</a>
                            </td>
                        </tr>
                        <tr class="even pointer">
                            <td class="a-center ">
                                <input type="checkbox" class="flat" name="table_records">
                            </td>
                            <td class=" ">121000040</td>
                            <td class=" ">May 24, 2014 11:47:56 PM </td>
                            <td class=" ">121000210</td>
                            <td class=" ">John Blank L</td>
                            <td class=" ">Paid</td>
                            <td class="a-right a-right ">$7.45</td>
                            <td class=" last"><a href="#">View</a>
                            </td>
                        </tr>
                        <tr class="odd pointer">
                            <td class="a-center ">
                                <input type="checkbox" class="flat" name="table_records">
                            </td>
                            <td class=" ">121000039</td>
                            <td class=" ">May 26, 2014 11:30:12 PM</td>
                            <td class=" ">121000208 <i class="error fa fa-long-arrow-down"></i>
                            </td>
                            <td class=" ">John Blank L</td>
                            <td class=" ">Paid</td>
                            <td class="a-right a-right ">$741.20</td>
                            <td class=" last"><a href="#">View</a>
                            </td>
                        </tr>
                        <tr class="even pointer">
                            <td class="a-center ">
                                <input type="checkbox" class="flat" name="table_records">
                            </td>
                            <td class=" ">121000038</td>
                            <td class=" ">May 26, 2014 10:55:33 PM</td>
                            <td class=" ">121000203</td>
                            <td class=" ">Mike Smith</td>
                            <td class=" ">Paid</td>
                            <td class="a-right a-right ">$432.26</td>
                            <td class=" last"><a href="#">View</a>
                            </td>
                        </tr>
                        <tr class="odd pointer">
                            <td class="a-center ">
                                <input type="checkbox" class="flat" name="table_records">
                            </td>
                            <td class=" ">121000037</td>
                            <td class=" ">May 26, 2014 10:52:44 PM</td>
                            <td class=" ">121000204</td>
                            <td class=" ">Mike Smith</td>
                            <td class=" ">Paid</td>
                            <td class="a-right a-right ">$333.21</td>
                            <td class=" last"><a href="#">View</a>
                            </td>
                        </tr>

                        <tr class="even pointer">
                            <td class="a-center ">
                                <input type="checkbox" class="flat" name="table_records">
                            </td>
                            <td class=" ">121000040</td>
                            <td class=" ">May 27, 2014 11:47:56 PM </td>
                            <td class=" ">121000210</td>
                            <td class=" ">John Blank L</td>
                            <td class=" ">Paid</td>
                            <td class="a-right a-right ">$7.45</td>
                            <td class=" last"><a href="#">View</a>
                            </td>
                        </tr>
                        <tr class="odd pointer">
                            <td class="a-center ">
                                <input type="checkbox" class="flat" name="table_records">
                            </td>
                            <td class=" ">121000039</td>
                            <td class=" ">May 28, 2014 11:30:12 PM</td>
                            <td class=" ">121000208</td>
                            <td class=" ">John Blank L</td>
                            <td class=" ">Paid</td>
                            <td class="a-right a-right ">$741.20</td>
                            <td class=" last"><a href="#">View</a>
                            </td>
                        </tr>
                        </tbody>

                    </table>

            </div>
        </div>
    </div>
</div>

<script>
    $(function(){
        load_tree();
        $("#add-category").click(function(){
            edit_category(0);
        });
    });
    function load_tree(){
        $( "#sortable ul" ).sortable({
            connectWith: '#sortable ul',
            placeholder: 'ui-state-highlight',
            distance: 5,
            update: function(event, ui){
                var newOrder = $(this).sortable('toArray').toString();
                var _parent = Number(ui.item[0].parentElement.id);
                var id_item = ui.item[0].id;

                $(".loading1").show();
                if (!isNaN(_parent))
                    id_parent = _parent;

                //$("#result").html("Datos a enviar: order=" + newOrder + "&parent=" + _parent + "&id=" + id_item)
                $.ajax({
                    type: "POST",
                    url:"<?php echo base_url(); ?>admin/category/order_category",
                    data: 'order=' + newOrder + '&parent=' + id_parent + '&id=' + id_item,
                    error: function(data){
                        //alert('error test');
                    },
                    success: function(data){
                        $( ".loading1").hide();
                    }
                });
                //
            }
        });
    }
    function edit_category(id){
        var element = $("#change-content");
        element.find(".modal-content").html("<div class='loading-content'>Đang tải dữ liệu, vui lòng đợi....</div>");
        element.modal('show');
        $.ajax({
            type: "POST",
            url:"<?php echo base_url(); ?>admin/category/edit/" + id,
            data: {'id': id },
            error: function(data){
                //alert('error test');
            },
            success: function(data){
                element.find(".modal-content").html(data);
                CKEDITOR.replace( "description");

                $("#save_edit_category").click(function(){
                    set_disable_form_element(element);
                    var content = CKEDITOR.instances['description'].getData();
                    var parent_id = $(".update-category select[name='parent_id']").val();
                    var title = $(".update-category input[name='title']").val();
                    if(title == ''){
                        $(".update-category input[name='title']").css('border', '1px solid red');
                        return false;
                    }
                    $.ajax({
                        type: "POST",
                        url:"<?php echo base_url(); ?>admin/category/update_category",
                        data: {'id': id, 'description': content, 'title': title, 'parent_id': parent_id },
                        dataType: 'json',
                        error: function(data){
                            //alert('error test');
                        },
                        success: function(data){
                            set_enable_form_element(element);
                            element.modal('hide');
                            $("#sortable div").html(data['tree']);
                            load_tree();
                            new PNotify({
                                title: 'Thông báo thành công',
                                text: data['success'],
                                type: 'success'
                            });
                        }
                    });

                });

            }
        });

    }


    function delete_category(id){
        var confirmBox = confirm('Bạn có muốn xóa không?');
        if (!confirmBox) return false;
        $(".loading1").show();
        $.ajax({
            type: "POST",
            url:"<?php echo base_url(); ?>admin/category/delete_category",
            data: {'id': id },
            error: function(data){
                //alert('error test');
            },
            success: function(data){
                $("#"+id).remove();
                $( ".loading1").hide();
            }
        });
    }


</script>


<script >
    $(function(){
        /*
         var btnUpload=$('#upload');
         new AjaxUpload(btnUpload, {
         action: '<?php echo base_url();	?>admin/media/upload',
         name: 'uploadfile',
         data: {},
         onSubmit: function(file, ext){
         if (! (ext && /^(jpg|png|jpeg|gif)$/.test(ext))){
         // extension is not allowed
         alert('Only JPG, PNG or GIF files are allowed');
         return false;
         }
         $(".loadings").show();
         },
         onComplete: function(file, response){
         //On completion clear the status
         //Add uploaded file to list
         $(".loadings").hide();
         if(response==="error"){
         //error return
         alert('error');
         } else{
         $("#logo").val(response);
         $('#thumb-logo').attr('src', '<?php echo base_url(); ?>' + response );

         }

         }
         });
         */
    });
</script>